<!DOCTYPE html>
<html>
	<head><title>LIVE 3PM!!</title>
	<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">

<style>
body {

	margin: 0px;
}
</style>
<link rel="stylesheet" href="/css/superj3.1.css">
<link rel="stylesheet" href="//code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
<script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>

<script>
var numberFadeSpeed = 350;
$(document).ready(function(){
	
	// Setup date picker
	$('#viewdate').datepicker({
		dateFormat: "dd/mm/yy",
		showButtonPanel: false,
		buttonText: "<>",
		onClose: function() {
			var url = "/index.php?id=1&r=d365Now";
			$.post(url,{'viewDate':this.value}, function(data){
				//alert("Data Loaded: " + data);
				location.reload();
			});
		}	
	}).on('change', function(){
		$('.datepicker').hide();
	});
	
	// Start Polling
	doPoll();
}); /* End $(document).ready */


function doPoll(){
	$.ajax({
			url:"/index.php?id=1&r=d365Now/polling",
			method: "POST",
			data: { "id" : 1 },
			dataType: "json"
	}).done(function(data) {
//			console.log(data);
//			console.log($.type(data));

		if(data['ERROR'] === "0") {
			$('.message').html("");
			
			var arrG1 = data['DATA'][0];

			if(data['DATA'][0]['DONE'] === "3") {
				$("#idrs13").attr('class', '');
				$('#idrs13').html("----");
				$("#idrs3").attr('class', 'g1rs-3');
			}
			if(data['DATA'][0]['DONE'] === "2") {
				$("#idrs12").attr('class', '');
				$('#idrs12').html("----");
				$("#idrs2").attr('class', 'g1rs-2');
			}
			if(data['DATA'][0]['DONE'] === "1") {
				$("#idrs11").attr('class', '');
				$('#idrs11').html("----");
				$("#idrs1").attr('class', 'g1rs-1');
			}

			if(data['DATA'][0]['DONE'] === "99") {
				$("#idrs13").attr('class', '');
				$('#idrs13').html("----");

				$("#idrs3").attr('class', 'g1rs-3');
				$("#idrs12").attr('class', '');
				$('#idrs12').html("----");
				$("#idrs2").attr('class', 'g1rs-2');
				$("#idrs11").attr('class', '');
				$('#idrs11').html("----");
				$("#idrs1").attr('class', 'g1rs-1');
			}
			if(data['DATA'][0]['DONE'] === "0") {

				$("#idrs3").attr('class', '');
				$("#idrs3").html("----");
				$("#idrs13").attr('class', 'g1rs-3');
			//	$('#idrs13').html("----");

				$("#idrs2").attr('class', '');
				$("#idrs2").html("----");
				$("#idrs12").attr('class', 'g1rs-2');
			//	$('#idrs12').html("----");

				$("#idrs1").attr('class', '');
				$("#idrs1").html("----");
				$("#idrs11").attr('class', 'g1rs-1');
			//	$('#idrs11').html("----");
			}



			if(Object.keys(arrG1).length === 24) {
				$.each(arrG1, function(vname, vvalue) {
					//console.log(vname + ')' + vvalue);
					
					if(vname !== 'DONE') {
						var curValue = $('.g1rs-'+vname).html();
						var lastestValue = vvalue;
						if(curValue !== lastestValue) {
							// Show this result
							updateNewResult($('.g1rs-'+vname), lastestValue);
							console.log("Update "+vname+" from " + curValue +" to "+ lastestValue);
						}
					}
				});
			}
		} else {
			$('.message').html("ERROR: " +data['DESC']);
		}
		setTimeout(doPoll,8000);
	})
	.fail(function( jqXHR, textStatus ) {
		//alert( "Network problem, request failed: " + textStatus );
		$('.message').html("ERROR: " +data['DESC']);
		setTimeout(doPoll,8000);
	});
}

function updateNewResult(target, value) 
{
	/*target.css('background-color','orange');*/
	target.fadeOut(numberFadeSpeed, function() {
		target.html(value);
		target.fadeIn(numberFadeSpeed * 5, function() {	
			target.css('background-color',''); 
		});
	});
}


/***** Clock running *****/
var myVar = setInterval(function() { myTimer();}, 1000);
function myTimer() {
	document.getElementById("runningClock").innerHTML = (new Date()).toLocaleTimeString();
}
</script>
</head>
<body>

<div class="message" style="text-align: center; width: 100%; background-color: darkorange;"></div>

<table style="width: 100%" border="0">
	<tr>
		<td style="width: 34%">
			
			<table style="padding:2px">
				<tr>
					<td><div style="font-size: xx-large; font-weight: bold; width: 33%;
   text-shadow: 3px 3px 2px #aaa;">3PM</div></td>
				</tr>
				<tr>
					<td style="text-align: right; font-size: xx-small; color:gray">&#10145; <a href="http://9pm.superj3.win">9pm</a></td>
				</tr>
			</table>
			
		</td>
		<td style="text-align: center;">
			
			<!--span style="font-size: x-large; font-weight: bold; font-style: italic">SuperJ3</span> - --> 

			
			<img style="vertical-align: middle; width: 80%" 
								 src="/images/superj3-logo.png">

		</td>
		
		<td style="text-align: right; width: 33%">
			<input id="viewdate" type="text" 
				   value="08/07/2023" size="8" 
				   style="text-align: center; font-weight: bold; cursor: default; border: 1px solid gray; background-color: white;
				   transform: scaleY(1.2); 
				   
				   ">						
		</td>
	</tr>
	<tr>
		<td colspan="3" style="text-align: center; background-color: darkred; border: 1px solid black;">
			<div style="color: white; font-weight:bold; font-size: medium">Live Draw <span id="runningClock">&nbsp;</span></div>
		</td>
	</tr>

</table>

<div style="font-weight:bold; text-align: center;font-family: monospace; color: #db0413">&#11088; 3PM &#11088;</div>

<table border="0" style="width:100%">
	<tr><td class="resultLabel" colspan="3">1st Prize</td>
		<td class="result " colspan="2"><span id="idrs1" class="" style="color:#db0413; font-size: larger; font-weight: bolder">----</span>&nbsp;</td></tr>

	<tr><td class="resultLabel" colspan="3">2nd Prize</td>
		<td class="result " colspan="2"><span id="idrs2" class="" style="color:#db0413; font-size: larger; font-weight: bolder">----</span>&nbsp;</td></tr>

	<tr><td class="resultLabel" colspan="3">3rd Prize</td>
		<td class="result " colspan="2"><span id="idrs3" class="">----</span>&nbsp;</td>
	</tr>

	<tr><td class="resultLabel" colspan="5">Special</td></tr>
	<tr>
		<td class="result  "><span class="g1rs-4 ">----</span>&nbsp;</td>
		<td class="result  "><span class="g1rs-5 ">----</span>&nbsp;</td>
		<td class="result  "><span class="g1rs-6 ">----</span>&nbsp;</td>
		<td class="result  "><span class="g1rs-7 ">----</span>&nbsp;</td>
		<td class="result  "><span class="g1rs-8 ">----</span>&nbsp;</td>
	</tr>
	<tr>
		<td class="result  "><span class="g1rs-9  ">----</span>&nbsp;</td>
		<td class="result  "><span class="g1rs-10 ">----</span>&nbsp;</td>
		<td class="result  "><span class="g1rs-11 ">----</span>&nbsp;</td>
		<td class="result  "><span class="g1rs-12 ">----</span>&nbsp;</td>
		<td class="result  "><span class="g1rs-13 ">----</span>&nbsp;</td>
	</tr>

	<tr class="row11-12-13">
		<td class="result  " colspan="2"><span id="idrs11" class="g1rs-1">----</span>&nbsp;</td>
		<td class="result  " colspan="1"><span id="idrs12" class="g1rs-2">----</span>&nbsp;</td>
		<td class="result  " colspan="2"><span id="idrs13" class="g1rs-3">----</span>&nbsp;</td>
	</tr>		


	<tr><td class="resultLabel" colspan="5">Consolation</td></tr>
	<tr>
		<td class="result  "><span class="g1rs-14 ">----</span>&nbsp;</td>
		<td class="result  "><span class="g1rs-15 ">----</span>&nbsp;</td>
		<td class="result  "><span class="g1rs-16 ">----</span>&nbsp;</td>
		<td class="result  "><span class="g1rs-17 ">----</span>&nbsp;</td>
		<td class="result  "><span class="g1rs-18 ">----</span>&nbsp;</td>
	</tr>
	<tr>
		<td class="result  "><span class="g1rs-19 ">----</span>&nbsp;</td>
		<td class="result  "><span class="g1rs-20 ">----</span>&nbsp;</td>
		<td class="result  "><span class="g1rs-21 ">----</span>&nbsp;</td>
		<td class="result  "><span class="g1rs-22 ">----</span>&nbsp;</td>
		<td class="result  "><span class="g1rs-23 ">----</span>&nbsp;</td>
	</tr>
</table>

<p>
	<div style="text-align: center"></div>
</p>


<table style="width: 100%">
	<tr>
		<td style="vertical-align: top; text-align: center; color: #cccccc" nowrap><b>* Final result are base on final display</b></td>
		<!--td style="text-align: right"><i style="font-weight: normal; font-size: small">Powered by</i><img style="width: 35%" src="/images/superj3-bg.png"></td-->
	</tr>
</table>

</body>
</html>
